<%= form_for @recurring_invoice, html: {data: {role: 'invoice', controller: controller_name, model: controller_name.classify.underscore}, class: 'invoice'} do |f| %>
  <% if @recurring_invoice.errors.any? %>
    <div id="error_explanation">
      <h2>
        <%= pluralize(@recurring_invoice.errors.count, "error") %>
        prohibited this invoice from being saved:
      </h2>
      <ul>
        <% @recurring_invoice.errors.full_messages.each do |message| %>
          <li>
            <%= message %>
          </li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <div class="row">
    <div class="col-xs-12 col-xl-8">
      <fieldset class="m-b-2">
        <legend class="m-b-1">
          <%= Common.human_attribute_name(:seller) %>
        </legend>
        <div class="mb-3">
          <%= f.label :seller %>
          <%= f.collection_select :seller_id, TradePartner.all, :id, :name, {}, {multiple: false, class: "form-control"} %>
        </div>
      </fieldset>
    </div>
  </div>
  <fieldset class="m-b-2">
    <legend class="m-b-1">
      <%= t("customer") %>
    </legend>
    <%= render partial: 'customers/form_fields', locals: {f: f} %>
    <%= f.hidden_field :customer_id %>
  </fieldset>
  <fieldset class="m-b-2">
    <legend class="m-b-1">
      <%= t("configuration") %>
    </legend>
    <div class="row">
      <div class="col-xs-12 col-xl-8">
        <div class="m-b-2">
          <div class="checkbox">
            <label>
              <%= f.check_box :enabled %>
              <%= t(".enable_invoice") %>
            </label>
          </div>
          <div class="checkbox">
            <label>
              <%= f.check_box :sent_by_email %>
              <%= t(".auto_send") %>
            </label>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6">
            <div class="mb-3">
              <%= f.label :starting_date %>
              <%= f.date_field :starting_date, class: 'form-control' %>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="mb-3">
              <%= f.label :finishing_date %>
              <%= f.date_field :finishing_date, class: 'form-control' %>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6">
            <div class="mb-3">
              <%= f.label :period %>
              <%= f.number_field :period, class: 'form-control' %>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="mb-3">
              <%= f.label :period_type %>
              <%= f.select :period_type, RecurringInvoice::PERIOD_TYPES, {}, {class: 'form-control c-select'} %>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6">
            <div class="mb-3">
              <%= f.label :max_occurrences %>
              <%= f.number_field :max_occurrences, class: 'form-control' %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </fieldset>
  <fieldset class="m-b-2" data-changes="amount">
    <legend class="m-b-1">
      <%= "#{t("invoice")} #{t("details")}" %>
    </legend>
    <div class="row">
      <div class="col-xs-12 col-xl-12">
        <div class="row">
          <div class="col-sm-4">
            <div class="mb-3">
              <%= f.label :series %>
              <%= f.collection_select :series_id, Series.enabled, :id, :to_s, {}, {class: 'form-control c-select'} %>
            </div>
          </div>
          <div class="col-sm-4">
            <div class="mb-3">
              <%= f.label :days_to_due %>
              <%= f.number_field :days_to_due, class: 'form-control' %>
            </div>
          </div>
          <div class="col-sm-4">
            <div class="mb-3">
              <%= f.label :currency %>
              <%= f.collection_select :currency, Money::Currency.all, :id, :iso_code, {}, {class: 'form-control c-select'} %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <%= render partial: 'shared/item_form', locals: {f: f, items: :items, invoice: @recurring_invoice} %>
  </fieldset>
  <fieldset class="m-b-2">
    <legend class="m-b-1">
      <%= t("tags") %>
    </legend>
    <%= render partial: 'shared/tagging_field', locals: {f: f, instance: @recurring_invoice} %>
  </fieldset>
  <fieldset class="m-b-2">
    <legend class="m-b-1">Meta Attributes</legend>
    <%= render partial: 'shared/meta_form', locals: {f: f, instance: @recurring_invoice} %>
  </fieldset>
<% end %>
